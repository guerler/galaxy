define(["utils/utils","mvc/ui/ui-table","mvc/ui/ui-portlet","mvc/ui/ui-misc"],function(a,b,c,d){var e=Backbone.View.extend({optionsDefault:{title:"Section",max:null,min:null},initialize:function(c){this.options=a.merge(c,this.optionsDefault),this.setElement("<div/>");this.button_new=new d.ButtonIcon({icon:"fa-plus",title:"Insert "+c.title_new,tooltip:"Add new "+c.title_new+" block",floating:"clear",onclick:function(){c.onnew&&c.onnew()}}),this.table=new b.View({cls:"ui-table-plain",content:""}),this.$el.append(this.table.$el),this.$el.append($("<div/>").append(this.button_new.$el)),this.list={},this.n=0},size:function(){return this.n},add:function(b){if(!b.id||this.list[b.id])return void a.emit.debug("form-repeat::add()","Duplicate repeat block id.");this.n++;var e=new d.ButtonIcon({icon:"fa-trash-o",tooltip:"Delete this repeat block",cls:"ui-button-icon-plain",onclick:function(){b.ondel&&b.ondel()}}),f=new c.View({id:b.id,title:"placeholder",cls:"ui-portlet-repeat",operations:{button_delete:e}});f.append(b.$el),f.$el.addClass("section-row"),this.list[b.id]=f,this.table.add(f.$el),this.table.append("row_"+b.id,!0),this.options.max>0&&this.n>=this.options.max&&this.button_new.disable(),this._refresh()},del:function(b){if(!this.list[b])return void a.emit.debug("form-repeat::del()","Invalid repeat block id.");this.n--;var c=this.table.get("row_"+b);c.remove(),delete this.list[b],this.button_new.enable(),this._refresh()},_refresh:function(){var a=0;for(var b in this.list){var c=this.list[b];c.title(++a+": "+this.options.title),this.n>this.options.min?c.showOperation("button_delete"):c.hideOperation("button_delete")}}});return{View:e}});
//# sourceMappingURL=../../../maps/mvc/form/form-repeat.js.map